[pytest]
# Disable pytest-flask plugin as we use FastAPI, not Flask
addopts = -p no:flask

# Limit test collection to proximity2/e2e_tests directory only
testpaths = proximity2/e2e_tests

# Set asyncio fixture loop scope to function to avoid deprecation warning
asyncio_default_fixture_loop_scope = function

# Suppress warnings from external libraries that we cannot fix
filterwarnings =
    ignore::DeprecationWarning:sqlalchemy.*
    ignore::DeprecationWarning:jose.*
    ignore::DeprecationWarning:httpx.*
    ignore:.*datetime.datetime.utcnow.*:DeprecationWarning
    ignore:.*Use 'content=<...>' to upload.*:DeprecationWarning
    ignore::urllib3.exceptions.InsecureRequestWarning
    ignore:.*coroutine.*was never awaited.*:RuntimeWarning
    ignore::RuntimeWarning:_pytest.unraisableexception
    ignore:.*Enable tracemalloc.*:RuntimeWarning
    ignore::ResourceWarning
    # Suppress PytestUnraisableExceptionWarning for background task polling
    # This is by design - BackupService._poll_backup_completion runs in background
    ignore::pytest.PytestUnraisableExceptionWarning
    # Python 3.13 metadata deprecation warnings from external packages
    ignore:Implicit None on return values is deprecated and will raise KeyErrors:DeprecationWarning:importlib.metadata
    ignore:Implicit None on return values is deprecated and will raise KeyErrors:DeprecationWarning:sentry_sdk
